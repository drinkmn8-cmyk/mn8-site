<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Qualification</title>

    <!-- IMPORTANT: bump v= number anytime you change CSS to break cache -->
    <link rel="stylesheet" href="./style.css?v=6" />

    <!-- Fix native select dropdown (white-on-white) without changing your site style -->
    <style>
      /* Native selects are stubborn. Force readable dropdown UI. */
      select.control {
        color-scheme: dark;
      }
      select.control,
      select.control option,
      select.control optgroup {
        background-color: #0f0f14 !important;
        color: rgba(255,255,255,.92) !important;
      }
      select.control:focus {
        outline: none;
        box-shadow: 0 0 0 4px rgba(91,53,166,.20);
        border-color: rgba(91,53,166,.55);
      }
      /* Placeholder option */
      select.control option[disabled] {
        color: rgba(255,255,255,.55) !important;
      }
    </style>
  </head>

  <body id="top">
    <!-- TOPBAR (same vibe as site) -->
    <header class="topbar">
      <div class="wrap topbar-inner">
        <a class="brand" href="./index.html#top" aria-label="MN8 Home">
          <img class="brand-logo" src="./logo.svg" alt="MN8" />
        </a>

<nav class="nav" aria-label="Primary">
  <a href="./index.html#mn8">What it is</a>
  <a href="./index.html#process">Process</a>
  <a href="./index.html#faq">FAQ</a>
</nav>


        <a class="btn btn-ghost btn-sm" href="./index.html#top">Back</a>
      </div>
    </header>

    <main>
      <section class="section">
        <div class="wrap">
          <div class="form-card">
            <h1 class="form-title">Qualification</h1>

            <form id="qualifyForm" novalidate>
              <!-- Optional client timestamp (Apps Script should still set the real timestamp) -->
              <input type="hidden" id="clientTimestamp" name="clientTimestamp" value="" />

              <div class="form-grid">
                <div class="field">
                  <label for="fullName">Full name</label>
                  <input
                    class="control"
                    id="fullName"
                    name="fullName"
                    type="text"
                    placeholder="Your name"
                    autocomplete="name"
                    required
                  />
                </div>

                <div class="field">
                  <label for="email">Email</label>
                  <input
                    class="control"
                    id="email"
                    name="email"
                    type="email"
                    placeholder="you@email.com"
                    autocomplete="email"
                    required
                  />
                </div>

                <div class="field" style="grid-column: 1 / -1;">
                  <label for="describe">Which best describes you?</label>
                  <select class="control" id="describe" name="describe" required>
                    <option value="" selected disabled>Select one</option>
                    <option value="High-responsibility professional">High-responsibility professional</option>
                    <option value="Entrepreneur / operator">Entrepreneur / operator</option>
                    <option value="Busy parent with a full schedule">Busy parent with a full schedule</option>
                    <option value="High performer rebuilding consistency">High performer rebuilding consistency</option>
                  </select>
                </div>

                <div class="field" style="grid-column: 1 / -1;">
                  <label for="breaks">What breaks consistency for you?</label>
                  <select class="control" id="breaks" name="breaks" required>
                    <option value="" selected disabled>Select one</option>
                    <option value="Schedule overload / no time margin">Schedule overload / no time margin</option>
                    <option value="Decision fatigue / mental load">Decision fatigue / mental load</option>
                    <option value="Travel / unpredictability">Travel / unpredictability</option>
                    <option value="Stress eating / low control at night">Stress eating / low control at night</option>
                  </select>
                </div>

                <div class="field" style="grid-column: 1 / -1;">
                  <label for="restarts">How often have you restarted?</label>
                  <select class="control" id="restarts" name="restarts" required>
                    <option value="" selected disabled>Select one</option>
                    <option value="Rarely">Rarely</option>
                    <option value="A few times a year">A few times a year</option>
                    <option value="Every 1–2 months">Every 1–2 months</option>
                    <option value="Constant cycle">Constant cycle</option>
                  </select>
                </div>

                <div class="field" style="grid-column: 1 / -1;">
                  <label for="result">What result would make this a win in 90 days?</label>
                  <input
                    class="control"
                    id="result"
                    name="result"
                    type="text"
                    placeholder="Example: -10 lbs while keeping my schedule"
                    required
                  />
                </div>

                <div class="field">
                  <label for="ready">If accepted, ready to start immediately?</label>
                  <select class="control" id="ready" name="ready" required>
                    <option value="" selected disabled>Select one</option>
                    <option value="Yes">Yes</option>
                    <option value="Within 7 days">Within 7 days</option>
                    <option value="Not yet">Not yet</option>
                  </select>
                </div>

                <div class="field">
                  <label for="structure">Can you follow a simple daily structure?</label>
                  <select class="control" id="structure" name="structure" required>
                    <option value="" selected disabled>Select one</option>
                    <option value="Yes">Yes</option>
                    <option value="Probably">Probably</option>
                    <option value="No">No</option>
                  </select>
                </div>

                <div class="field" style="grid-column: 1 / -1;">
                  <label for="why">Why MN8 specifically?</label>
                  <textarea class="control" id="why" name="why" placeholder="One sentence is enough." required></textarea>
                </div>
              </div>

              <div class="form-actions">
                <button class="btn btn-primary" id="submitBtn" type="submit">Submit Qualification</button>
                <span class="form-note" id="formNote">You’ll receive next steps by email if approved.</span>
              </div>
            </form>
          </div>
        </div>
      </section>
    </main>

<script>
  const ENDPOINT_URL =
  "https://script.google.com/macros/s/AKfycby507iyY9bLh22nI8p4jlMFi142Oy8H28VAsmuQqL7uX_NisrZs7nrCshU7bpXp9xEB/exec";
  
  const form = document.getElementById("qualifyForm");
  const submitBtn = document.getElementById("submitBtn");
  const formNote = document.getElementById("formNote");
  const clientTs = document.getElementById("clientTimestamp");

  clientTs.value = new Date().toISOString();

  function setLoading(isLoading) {
    submitBtn.disabled = isLoading;
    submitBtn.textContent = isLoading ? "Submitting..." : "Submit Qualification";
    formNote.textContent = isLoading
      ? "Submitting securely…"
      : "You’ll receive next steps by email if approved.";
  }

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    // browser validation
    if (!form.checkValidity()) {
      form.reportValidity();
      return;
    }

    const payload = Object.fromEntries(new FormData(form).entries());
    payload.userAgent = navigator.userAgent;
    payload.pageUrl = location.href;
    payload.clientTimestamp = new Date().toISOString();

    try {
      setLoading(true);

      // KEY CHANGE: no-cors, don't try to read response (CORS will block it)
      await fetch(ENDPOINT_URL, {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "text/plain;charset=utf-8" },
        body: JSON.stringify(payload),
      });

      // If the request was sent, we treat as success.
      alert("Submitted. You’ll receive next steps by email if approved.");
      form.reset();
      clientTs.value = new Date().toISOString();
    } catch (err) {
      console.error(err);
      alert("Submission failed. Please try again.");
    } finally {
      setLoading(false);
    }
  });
</script>
  </body>
</html>
